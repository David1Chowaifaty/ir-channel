{"version":3,"file":"ir-channel-mapping.js","sourceRoot":"","sources":["../../../../src/components/ir-channel/ir-channel-mapping/ir-channel-mapping.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Fragment, Host, State, h } from '@stencil/core';\r\nimport { IrMappingService } from './ir-mapping.service';\r\nimport channels_data, { addMapping, setMappedChannel } from '@/stores/channel.store';\r\nimport { RoomDetail, RatePlanDetail } from '@/models/IBooking';\r\nimport locales from '@/stores/locales.store';\r\n\r\n@Component({\r\n  tag: 'ir-channel-mapping',\r\n  styleUrl: 'ir-channel-mapping.css',\r\n  scoped: true,\r\n})\r\nexport class IrChannelMapping {\r\n  @State() activeMapField = '';\r\n  @State() availableRooms: { id: string; name: string }[] = [];\r\n\r\n  private mappingService = new IrMappingService();\r\n\r\n  setActiveField(id: string, isRoomType: boolean, roomTypeId?: string) {\r\n    const availableRooms = this.mappingService.getAppropriateRooms(isRoomType, roomTypeId);\r\n    if (availableRooms) {\r\n      this.availableRooms = availableRooms;\r\n    }\r\n    this.activeMapField = id;\r\n  }\r\n\r\n  renderMappingStatus(\r\n    mappedField:\r\n      | {\r\n          hide: boolean;\r\n          result: RoomDetail;\r\n          occupancy?: number;\r\n        }\r\n      | {\r\n          hide: boolean;\r\n          result: RatePlanDetail;\r\n          occupancy?: number;\r\n        },\r\n    id: string,\r\n    isRoomType: boolean,\r\n    roomTypeId?: string,\r\n  ) {\r\n    if (mappedField.hide) {\r\n      return <td></td>;\r\n    }\r\n    if (mappedField.result) {\r\n      return (\r\n        <Fragment>\r\n          <td class=\"px-2 d-sm-none text-blue d-flex align-items-center\">\r\n            <span class=\"m-0 p-0 d-flex align-items-center selected-map\">\r\n              <span class=\"selected-map-title\">{mappedField.result.name}</span>\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                <path\r\n                  fill={'var(--blue)'}\r\n                  d=\"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z\"\r\n                />\r\n              </svg>\r\n              {mappedField.occupancy}\r\n            </span>\r\n            <ir-icon class=\"ml-1 p-0\" onIconClickHandler={() => this.mappingService.removedMapping(mappedField.result.id.toString(), isRoomType)}>\r\n              <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                <path\r\n                  fill={'var(--blue)'}\r\n                  d=\"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z\"\r\n                />\r\n              </svg>\r\n            </ir-icon>\r\n          </td>\r\n          <td class=\"px-2 d-none text-blue d-sm-flex align-items-center\">\r\n            <span class=\"m-0 p-0 d-flex align-items-center selected-map\">\r\n              {mappedField.result.name}\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                <path\r\n                  fill={'var(--blue)'}\r\n                  d=\"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z\"\r\n                />\r\n              </svg>\r\n              {mappedField.occupancy}\r\n            </span>\r\n            <ir-icon class=\"ml-1 p-0\" onIconClickHandler={() => this.mappingService.removedMapping(mappedField.result.id.toString(), isRoomType)}>\r\n              <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                <path\r\n                  fill={'var(--blue)'}\r\n                  d=\"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z\"\r\n                />\r\n              </svg>\r\n            </ir-icon>\r\n          </td>\r\n        </Fragment>\r\n      );\r\n    }\r\n    return (\r\n      <td class=\"px-2\">\r\n        {this.activeMapField === id ? (\r\n          <ir-combobox\r\n            autoFocus\r\n            placeholder={locales.entries?.Lcz_ConnectedChannel}\r\n            data={this.availableRooms}\r\n            onComboboxValueChange={e => {\r\n              addMapping(e.detail.data as string, this.activeMapField, isRoomType);\r\n              this.activeMapField = '';\r\n            }}\r\n          ></ir-combobox>\r\n        ) : (\r\n          <span class=\"cursor-pointer text-danger\" onClick={() => this.setActiveField(id, isRoomType, roomTypeId)}>\r\n            {locales.entries.Lcz_NotMapped}\r\n          </span>\r\n        )}\r\n      </td>\r\n    );\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"d-flex w-100 justify-content-end\">\r\n          <button\r\n            onClick={() => {\r\n              setMappedChannel();\r\n            }}\r\n            class=\"btn refresh-btn\"\r\n          >\r\n            {locales.entries?.Lcz_Refresh}\r\n          </button>\r\n        </div>\r\n        <table class=\"m-0 p-0 w-100\">\r\n          <thead class={'py-1'}>\r\n            <tr class=\"py-1\">\r\n              <th scope=\"col\" class=\"py-1 pr-3\">\r\n                {channels_data.selectedChannel?.name}\r\n              </th>\r\n              <td>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                  <path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\" />\r\n                </svg>\r\n              </td>\r\n              <th scope=\"col\" class=\"px-2\">\r\n                Igloorooms\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {channels_data.selectedChannel?.property?.room_types?.map(room_type => {\r\n              const mappedRoomType = this.mappingService.checkMappingExists(room_type.id, true);\r\n              return (\r\n                <Fragment>\r\n                  <tr key={room_type.id} class=\"mb-1\">\r\n                    <td>{room_type.name}</td>\r\n                    <td>\r\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                        <path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\" />\r\n                      </svg>\r\n                    </td>\r\n                    {this.renderMappingStatus(mappedRoomType, room_type.id, true)}\r\n                  </tr>\r\n\r\n                  {room_type.rate_plans.map(rate_plan => {\r\n                    const mappedRatePlan = this.mappingService.checkMappingExists(rate_plan.id, false, room_type.id);\r\n                    return (\r\n                      <tr key={rate_plan.id} class=\"\">\r\n                        <td class=\"submap-text mb-1\">{rate_plan.name}</td>\r\n                        <td>\r\n                          {!mappedRatePlan.hide && (\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                              <path\r\n                                fill=\"currentColor\"\r\n                                d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\"\r\n                              />\r\n                            </svg>\r\n                          )}\r\n                        </td>\r\n                        {this.renderMappingStatus(mappedRatePlan, rate_plan.id, false, room_type.id)}\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                  <tr>\r\n                    <td class=\"py-1\"></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                  </tr>\r\n                </Fragment>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}