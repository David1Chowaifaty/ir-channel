import{r as t,c as e,h as i,H as s,F as a,g as o}from"./p-c8e6073c.js";import{l as r}from"./p-f24c2f6c.js";import{c as n}from"./p-14712fa4.js";import{h}from"./p-6c4ba7c0.js";import{B as c}from"./p-1c70a483.js";import{c as d}from"./p-5ec9e53a.js";import{v as l}from"./p-4ed69de7.js";import"./p-103ecfd7.js";import"./p-f33057f4.js";import"./p-5872a6ca.js";const p=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}";const f=p;const u=class{constructor(i){t(this,i);this.dateSelectEvent=e(this,"dateSelectEvent",7);this.toast=e(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.withDateDifference=true;this.renderAgain=false}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:this.fromDateStr,toDateStr:this.toDateStr,dateDifference:this.totalNights})}}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}calculateTotalNights(){this.totalNights=n(h(this.fromDate).format("YYYY-MM-DD"),h(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){return i(s,{key:"5f12bce02bf083ee1f83213b463c8ab6218b31dd"},i("div",{key:"4de337a6dec55b3adf2a7bfdd25f202332cdac39",class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},i("ir-date-picker",{key:"1bf65df8d95865c18630aa7fb9bc5e50028cae81",maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),i("div",{key:"5c6cab473acfd220bd656e405d25e762aaa79636","data-state":this.disabled?"disabled":"active",class:"date-view"},i("svg",{key:"c97ee69fe0a9818213733ce3eee7e0ee00aa7258",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},i("path",{key:"6e1ae3f72291757ce444821e2688424475a88748",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),i("ir-date-view",{key:"a8328e5c8f87a703eecea36ddc5168a7f8ee7356",showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&i("span",null,this.totalNights&&!this.disabled?i("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${r.entries.Lcz_Nights}`:` ${r.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};u.style=f;const m=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const b=m;const g=class{constructor(i){t(this,i);this.comboboxValue=e(this,"comboboxValue",7);this.inputCleared=e(this,"inputCleared",7);this.toast=e(this,"toast",7);this.bookingService=new c;this.no_result_found="";this.duration=300;this.placeholder="";this.propertyId=undefined;this.isSplitBooking=false;this.type="text";this.name="";this.inputId=l();this.required=false;this.disabled=false;this.value=undefined;this.from_date="";this.to_date="";this.danger_border=undefined;this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputFocused=false}componentWillLoad(){this.bookingService.setToken(d.token);this.no_result_found=r.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const a=t+s;const o=a*this.selectedIndex;let r=o-e/2+t/2;r=Math.max(0,Math.min(r,i.scrollHeight-e));i.scrollTo({top:r,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return i("div",{class:`position-absolute border rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,e)=>i("p",{role:"button",onKeyDown:t=>this.handleItemKeyDown(t,e),"data-selected":this.selectedIndex===e,tabIndex:0,onClick:()=>this.selectItem(e)},this.isSplitBooking?i(a,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):i("div",{class:"d-flex align-items-center flex-fill"},i("p",{class:"p-0 m-0"},`${t.email}`," ",i("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&i("div",{class:"loader-container d-flex align-items-center justify-content-center"},i("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&i("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return i(s,{key:"9c97f877f84b1118e1f05d77c2564834a1bc6489"},i("div",{key:"ee8f1058c3bdc4975c7a908859b652f8e8027f9b",class:"d-flex align-items-center "},i("label",{key:"08874c294014ce78ae11959b540fcce91bfe8dbd","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},i("svg",{key:"e8f86e515d3ee0b19853b354451f657e849837f0",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},i("path",{key:"2ae74f71cb49cd5d098c5834c6567b2093c22a85",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("input",{key:"c260c61ab3eb5e30fe6efdd12e1515fa4aad9f78",required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&i("button",{type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},i("p",{class:"sr-only"},"clear input"),i("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return o(this)}};g.style=b;const x="input.sc-ir-date-picker{all:unset;box-sizing:border-box !important;padding:0;margin:0;width:100%;text-align:center}input.sc-ir-date-picker:disabled{text-align:start;font-size:14px;width:100%}.sc-ir-date-picker-h{position:relative;box-sizing:border-box}.icon.sc-ir-date-picker{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}";const w=x;const v=class{constructor(i){t(this,i);this.dateChanged=e(this,"dateChanged",7);this.fromDate=undefined;this.toDate=undefined;this.opens=undefined;this.autoApply=undefined;this.firstDay=1;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.daysOfWeek=["Su","Mo","Tu","We","Th","Fr","Sa"];this.format="MMM DD, YYYY";this.separator=" - ";this.applyLabel="Apply";this.cancelLabel="Cancel";this.fromLabel="Form";this.toLabel="To";this.customRangeLabel="Custom";this.weekLabel="W";this.disabled=false;this.singleDatePicker=false;this.minDate=undefined;this.maxDate=undefined;this.maxSpan={days:240}}componentDidLoad(){this.dateRangeInput=this.element.querySelector(".date-range-input");$(this.dateRangeInput).daterangepicker({singleDatePicker:this.singleDatePicker,opens:this.opens,startDate:h(this.fromDate),endDate:h(this.toDate),minDate:h(this.minDate||h(new Date).format("YYYY-MM-DD")),maxDate:this.maxDate?h(this.maxDate):undefined,maxSpan:this.maxSpan,autoApply:this.autoApply,locale:{format:this.format,separator:this.separator,applyLabel:this.applyLabel,cancelLabel:this.cancelLabel,fromLabel:this.fromLabel,toLabel:this.toLabel,customRangeLabel:this.customRangeLabel,weekLabel:this.weekLabel,daysOfWeek:this.daysOfWeek,monthNames:this.monthNames,firstDay:this.firstDay}},((t,e)=>{this.dateChanged.emit({start:t,end:e})}))}render(){return i(s,{key:"0d6cf5576729c597cac56179683a2123e579b781"},i("input",{key:"ce33ffd58b812fbb8eb89ba851a1eb2512b0e1b0",class:"date-range-input",type:"text",disabled:this.disabled}))}get element(){return o(this)}};v.style=w;export{u as igl_date_range,g as ir_autocomplete,v as ir_date_picker};
//# sourceMappingURL=p-1080937f.entry.js.map